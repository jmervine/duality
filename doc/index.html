<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title>
  File: README
  
    &mdash; Documentation by YARD 0.8.2.1
  
</title>

  <link rel="stylesheet" href="css/style.css" type="text/css" media="screen" charset="utf-8" />

  <link rel="stylesheet" href="css/common.css" type="text/css" media="screen" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  hasFrames = window.top.frames.main ? true : false;
  relpath = '';
  framesUrl = "frames.html#!" + escape(window.location.href);
</script>


  <script type="text/javascript" charset="utf-8" src="js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="js/app.js"></script>


  </head>
  <body>
    <div id="header">
      <div id="menu">
  
    <a href="_index.html">Index</a> &raquo; 
    <span class="title">File: README</span>
  

  <div class="noframes"><span class="title">(</span><a href="." target="_top">no frames</a><span class="title">)</span></div>
</div>

      <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="class_list.html">
      Class List
    </a>
  
    <a class="full_list_link" id="method_list_link"
        href="method_list.html">
      Method List
    </a>
  
    <a class="full_list_link" id="file_list_link"
        href="file_list.html">
      File List
    </a>
  
</div>
      <div class="clear"></div>
    </div>

    <iframe id="search_frame"></iframe>

    <div id="content"><div id='filecontents'><h3>Duality</h3>

<p><a href="http://github.com/rubyops/duality">Duality</a> is a simple cache helper for using multiple caches. The idea is that you have local cache and a shared cache -- or fast and slow cache -- and want to save to both, and read from local, if present and shared if not. The idea came from <a href="http://www.virgentech.com/">Hector Virgen</a> (the PHP Zend Jedi Ninja Badass) and <a href="http://framework.zend.com/manual/en/zend.cache.backends.html#zend.cache.backends.twolevels">Zend<em>Cache</em>Backend_TwoLevels</a>, which does basically the same thing in PHP.</p>

<p>A few things to note:</p>

<ul>
<li>It currently implements the methods of my other two cache projects -- <a href="/tag/diskcached">Diskcached</a> and <a href="/tag/mongocached">Monogocached</a>, both which take their implementation from the popular <a href="https://rubygems.org/gems/memcached">Memcached</a>.</li>
<li>I&#39;m working on a Rails implementation, which uses <a href="http://api.rubyonrails.org/classes/ActiveSupport/Cache/Store.html">ActiveSupport::Cache::Store</a> -- more to come on that later.</li>
<li>My origional intent was to make sets asynchronous, but benchmarking shows that to be less efficent due either to my lack of knowledge in threaded development, or -- based on what I&#39;m reading -- ruby inefficenies in threading.</li>
</ul>

<h3>Installation</h3>

<pre class="code ruby"><code>    <span class='id identifier rubyid_gem'>gem</span> <span class='id identifier rubyid_install'>install</span> <span class='id identifier rubyid_duality'>duality</span> 
</code></pre>

<p>Or via bundler:</p>

<pre class="code ruby"><code><span class='comment'># file: Gemfile
</span><span class='id identifier rubyid_source'>source</span> <span class='symbol'>:rubygems</span>
<span class='id identifier rubyid_gem'>gem</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>duality</span><span class='tstring_end'>'</span></span>
</code></pre>

<h3>Basic Usage</h3>

<pre class="code ruby"><code><span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>diskcached</span><span class='tstring_end'>'</span></span>
<span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>mongocached</span><span class='tstring_end'>'</span></span> <span class='comment'># or memcached if you prefer
</span><span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>duality</span><span class='tstring_end'>'</span></span>

<span class='gvar'>$cache</span> <span class='op'>=</span> <span class='const'>Dulatiy</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='const'>Diskcached</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='comma'>,</span> <span class='const'>Mongocached</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span> <span class='label'>host:</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>remotehost</span><span class='tstring_end'>'</span></span> <span class='rparen'>)</span><span class='rparen'>)</span>

<span class='comment'># cache something
</span><span class='gvar'>$cache</span><span class='period'>.</span><span class='id identifier rubyid_set'>set</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>cache_key</span><span class='tstring_end'>'</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>cache_content</span><span class='tstring_end'>'</span></span><span class='rparen'>)</span>

<span class='comment'># get cache
</span><span class='id identifier rubyid_puts'>puts</span> <span class='gvar'>$cache</span><span class='period'>.</span><span class='id identifier rubyid_get'>get</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>cache_key</span><span class='tstring_end'>'</span></span><span class='rparen'>)</span> <span class='comment'># =&gt; cache_content
</span>
<span class='comment'># delete something
</span><span class='gvar'>$cache</span><span class='period'>.</span><span class='id identifier rubyid_delete'>delete</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>cache_key</span><span class='tstring_end'>'</span></span><span class='rparen'>)</span>

<span class='comment'># flush cache
</span><span class='gvar'>$cache</span><span class='period'>.</span><span class='id identifier rubyid_flush'>flush</span>
</code></pre>

<h3>Unimplemented Cache Methods</h3>

<p>One thing Duality does for compatability is pass methods via #method_missing. This allows for you to access any method your cache might implement, even if Duality doesn&#39;t itself implement it. </p>

<p>It&#39;s important to note, though, that the this implementation does not take advantage of the get methods speed increase by returning the faster cache first, but will perform the action in a serialized fashion on one cache, then the other. Additionally, by default, it will return the value of whichever cache works, meaning that if one raises and exception, returns false or nil, but the other returns successfully, it will return the successful result. This is by design.</p>

<p>To force both caches to &quot;be good or die&quot;, I&#39;ve implemented <strong>strict calls</strong>, where by you can prepend &quot;strict_&quot; to any method call which you know Duality doesn&#39;t implement and force it to fail if both caches don&#39;t return a valid result.</p>

<p>Another thing that&#39;s worth mentioning is if either cache raise an exception, it will be caught. If both caches raise an exception, <em>nil</em> will be returned. Also, if both caches return <em>nil</em>, <em>nil</em> will be returned.</p>

<h5>Example</h5>

<pre class="code ruby"><code><span class='comment'># when only one cache contains requested method
</span>
<span class='gvar'>$cache</span><span class='period'>.</span><span class='id identifier rubyid_one_only_method'>one_only_method</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>cache_key</span><span class='tstring_end'>'</span></span><span class='rparen'>)</span> 
<span class='comment'># =&gt; returns implementing caches return value
</span>
<span class='gvar'>$cache</span><span class='period'>.</span><span class='id identifier rubyid_strict_one_only_method'>strict_one_only_method</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>cache_key</span><span class='tstring_end'>'</span></span><span class='rparen'>)</span> 
<span class='comment'># =&gt; raises no method exception
</span>
<span class='comment'>#
</span><span class='comment'># when both caches contains requested method
</span>
<span class='gvar'>$cache</span><span class='period'>.</span><span class='id identifier rubyid_both_only_method'>both_only_method</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>cache_key</span><span class='tstring_end'>'</span></span><span class='rparen'>)</span>
<span class='comment'># =&gt; returns best match
</span>
<span class='gvar'>$cache</span><span class='period'>.</span><span class='id identifier rubyid_strict_both_only_method'>strict_both_only_method</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>cache_key</span><span class='tstring_end'>'</span></span><span class='rparen'>)</span>
<span class='comment'># =&gt; returns best match
</span></code></pre>

<h3>More Info</h3>

<h4><a href="http://rubyops.github.com/duality/doc/Duality.html">Documentation</a></h4>

<h4><a href="http://rubyops.github.com/duality/coverage/">Coverage</a></h4>

<h4><a href="https://github.com/rubyops/duality/blob/master/BENCHMARK.md">Benchmarks</a></h4>
</div></div>

    <div id="footer">
  Generated on Mon Jul 23 00:47:33 2012 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.8.2.1 (ruby-1.9.3).
</div>

  </body>
</html>